<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Medis - Murni Teguh Memorial Hospital</title>
    <style>
        /* --- CSS STYLE START --- */
        * { box-sizing: border-box; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        body { font-family: 'Arial', sans-serif; font-size: 13px; background-color: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 850px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }

        .header-container { text-align: center; margin-bottom: 5px; }
        .header-image { max-width: 100%; height: auto; display: block; margin: 0 auto; }

        /* MENU TABS */
        .menu-container { display: flex; justify-content: center; gap: 5px; margin-bottom: 20px; flex-wrap: wrap; }
        .btn-tab { padding: 10px 20px; border: none; background: #ddd; cursor: pointer; border-radius: 5px; font-weight: bold; }
        .btn-tab.active { background: #4CAF50; color: white; }

        /* DATA PASIEN */
        .patient-total-wrapper { display: flex; gap: 20px; margin-bottom: 20px; border: 1px solid #ddd; padding: 15px; border-radius: 8px; align-items: stretch; }
        .patient-info { flex: 1; }
        .info-line { display: grid; grid-template-columns: 140px 10px auto; margin-bottom: 5px; border-bottom: 1px dashed #eee; padding-bottom: 2px; }
        .info-line .label { font-weight: bold; color: #555; }
        .info-line-malnutrisi { display: none; }
        body.mode-malnutrisi .info-line-malnutrisi { display: grid; }

        /* OUTPUT BOXES */
        .output-box { width: 220px; padding: 15px; border: 2px solid #4CAF50; border-radius: 8px; text-align: center; background: #e8f5e9; display: none; flex-direction: column; justify-content: center; }
        .output-title { font-weight: bold; color: #2E7D32; margin-bottom: 5px; }
        .output-value { font-size: 24px; font-weight: bold; color: #333; }

        /* INPUT FORMS */
        .input-form { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 15px; background-color: #f9f9f9; border-radius: 8px; border: 1px solid #eee; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: bold; font-size: 11px; margin-bottom: 3px; }
        .form-group input, .form-group select { padding: 6px; border: 1px solid #ccc; border-radius: 4px; width: 100%; }

        /* CHECKBOX GRID */
        .checkbox-grid { grid-column: 1 / -1; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .form-section-title { grid-column: 1 / -1; font-weight: bold; margin-top: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }

        /* TABLES */
        .scoring-table { width: 100%; border-collapse: collapse; margin-top: 15px; page-break-inside: avoid; }
        .scoring-table th, .scoring-table td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
        .scoring-table th { background-color: #f2f2f2; }
        .highlight-natrium { background-color: #e8f5e9; font-weight: bold; }

        /* MALNUTRISI FORM TABLE */
        .malnutrisi-form-table { width: 100%; border-collapse: collapse; margin-top: 5px; }
        .malnutrisi-form-table th { background: #37474f; color: white; padding: 8px; text-align: center; font-size: 12px; border: 1px solid #999; }
        .malnutrisi-form-table td { border: 1px solid #aaa; padding: 6px 8px; vertical-align: top; font-size: 12px; }
        .col-no { width: 32px; text-align: center; font-weight: bold; }
        .col-jenis { width: 210px; }
        .col-terapi { }
        .sub-label { padding-left: 18px; font-style: italic; }
        .malnutrisi-textarea { width: 100%; border: none; background: transparent; resize: vertical; min-height: 48px; font-family: Arial, sans-serif; font-size: 12px; outline: none; line-height: 1.5; }
        .malnutrisi-textarea:focus { background: #f0f7ff; border-radius: 3px; }

        /* HELPER CALCULATOR BOX */
        .helper-box { background: #e3f2fd; border: 1px solid #1976D2; border-radius: 8px; padding: 12px; margin-bottom: 12px; }
        .helper-box-title { font-weight: bold; color: #1565C0; font-size: 13px; margin-bottom: 8px; }
        .helper-results { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 8px; }
        .helper-result-item { background: white; border-radius: 5px; padding: 8px; text-align: center; border: 1px solid #90CAF9; }
        .helper-result-item .hval { font-size: 22px; font-weight: bold; color: #1565C0; }
        .helper-result-item .hlabel { font-size: 10px; color: #666; margin-top: 2px; }
        .enteral-helper { margin-top: 10px; background: #e8f5e9; border: 1px solid #4CAF50; border-radius: 6px; padding: 10px; }
        .enteral-helper-title { font-weight: bold; color: #2E7D32; font-size: 12px; margin-bottom: 6px; }
        .enteral-results { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        .enteral-result-item { background: white; border-radius: 4px; padding: 6px; text-align: center; border: 1px solid #A5D6A7; }
        .enteral-result-item .eval { font-size: 18px; font-weight: bold; color: #2E7D32; }
        .enteral-result-item .elabel { font-size: 10px; color: #555; }
        .autofill-btn { margin-top: 8px; padding: 5px 12px; background: #1976D2; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; }
        .autofill-btn:hover { background: #1565C0; }

        /* KESIMPULAN */
        .kesimpulan-box { margin-top: 15px; padding: 12px 16px; border: 2px solid #333; border-radius: 4px; }
        .kesimpulan-title { font-weight: bold; text-decoration: underline; margin-bottom: 10px; font-size: 13px; }
        .kesimpulan-catatan { font-size: 11px; margin-bottom: 10px; background: #fff8e1; border-left: 3px solid #FFC107; padding: 8px; line-height: 1.5; }
        .kesimpulan-options { display: flex; gap: 30px; align-items: center; }
        .kesimpulan-options label { display: flex; align-items: center; gap: 8px; font-weight: bold; font-size: 13px; cursor: pointer; }
        .kesimpulan-options input[type="radio"] { width: 16px; height: 16px; cursor: pointer; }

        /* FOOTER */
        .footer-section { display: flex; justify-content: space-between; align-items: flex-end; margin-top: 20px; page-break-inside: avoid; }
        .dpjp-section { text-align: center; min-width: 200px; margin-left: auto; }
        .dpjp-input { margin-top: 5px; width: 100%; padding: 5px; text-align: center; }
        .dpjp-name { margin-top: 60px; font-weight: bold; border-bottom: 1px solid #000; padding-bottom: 5px; min-height: 20px; }
        .button-container { display: flex; gap: 10px; }
        .btn-action { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; color: white; font-weight: bold; }
        .btn-print { background: #2196F3; }
        .btn-clear { background: #f44336; }
        .dpjp-title-malnutrisi { display: none; }
        body.mode-malnutrisi .dpjp-title-default { display: none; }
        body.mode-malnutrisi .dpjp-title-malnutrisi { display: block; }

        /* PRINT RULES */
        @media print {
            @page { size: A4; margin: 10mm; }
            body { background: white; padding: 0; }
            .container { width: 100%; max-width: 100%; box-shadow: none; border: none; padding: 0; margin: 0; }
            .screen-only { display: none !important; }
            .patient-total-wrapper { border: 1px solid #000; }
            .footer-section { justify-content: flex-end; }
            .dpjp-section { margin-left: auto !important; }

            #calc-natrium-content, #calc-kalium-content, #calc-psi-content, #calc-malnutrisi-content,
            #natrium-output-box, #kalium-output-box, #psi-output-box, #malnutrisi-output-box { display: none !important; }

            body.mode-psi #calc-psi-content { display: block !important; }
            body.mode-psi #psi-output-box { display: flex !important; border: 2px solid #000 !important; }

            body.mode-natrium #calc-natrium-content { display: block !important; }
            body.mode-natrium #natrium-output-box { display: flex !important; border: 2px solid #000 !important; }

            body.mode-kalium #calc-kalium-content { display: block !important; }
            body.mode-kalium #kalium-output-box { display: flex !important; border: 2px solid #000 !important; }

            body.mode-malnutrisi #calc-malnutrisi-content { display: block !important; }
            body.mode-malnutrisi #malnutrisi-output-box { display: flex !important; border: 2px solid #000 !important; }
            body.mode-malnutrisi .helper-box { display: none !important; }
            body.mode-malnutrisi .autofill-btn { display: none !important; }
            body.mode-malnutrisi .info-line-malnutrisi { display: grid !important; }
            .malnutrisi-textarea { min-height: 40px; }
            .malnutrisi-form-table td, .malnutrisi-form-table th { border: 1px solid #000; }
        }
        /* --- CSS END --- */
    </style>
</head>
<body class="mode-psi">
    <div class="container">
        <div class="header-container">
            <img src="header.jpg" alt="Header" class="header-image">
        </div>

        <!-- TAB MENU -->
        <div class="menu-container screen-only">
            <button onclick="showCalculator('psi')" id="btn-psi" class="btn-tab active">PSI Score</button>
            <button onclick="showCalculator('natrium')" id="btn-natrium" class="btn-tab">Koreksi Natrium</button>
            <button onclick="showCalculator('kalium')" id="btn-kalium" class="btn-tab">Koreksi Kalium</button>
            <button onclick="showCalculator('malnutrisi')" id="btn-malnutrisi" class="btn-tab" style="background:#795548; color:white;">Tatalaksana Malnutrisi</button>
        </div>

        <!-- PATIENT INFO HEADER -->
        <div class="patient-total-wrapper">
            <div class="patient-info">
                <div class="info-line"><span class="label">Nama</span><span>:</span><span id="displayNama">-</span></div>
                <div class="info-line"><span class="label">No. MR</span><span>:</span><span id="displayNoMR">-</span></div>
                <div class="info-line"><span class="label">Tgl Lahir</span><span>:</span><span id="displayTglLahir">-</span></div>
                <div class="info-line"><span class="label">Umur</span><span>:</span><span id="displayUmur">-</span></div>
                <div class="info-line"><span class="label">Tgl Assessment</span><span>:</span><span id="displayTglAsesmen">-</span></div>
                <!-- Hanya tampil di mode malnutrisi -->
                <div class="info-line info-line-malnutrisi"><span class="label">Ruang</span><span>:</span><span id="displayRuang">-</span></div>
                <div class="info-line info-line-malnutrisi"><span class="label">Jam</span><span>:</span><span id="displayJam">-</span></div>
            </div>

            <div id="psi-output-box" class="output-box">
                <div class="output-title">PSI Score</div>
                <div class="output-value" id="totalScore">0</div>
                <div class="output-label">Kelas: <span id="kelasRisiko">-</span></div>
                <div class="output-label" style="font-size: 11px;">Mortality: <span id="mortalityRate">-</span></div>
            </div>

            <div id="natrium-output-box" class="output-box">
                <div class="output-title">Delta Na+</div>
                <div class="output-value"><span id="displayDeltaTotal">0</span> <small>mEq</small></div>
                <div class="output-label"><span id="displayNaAwal">0</span> &rarr; <span id="displayNaTarget">0</span></div>
            </div>

            <div id="kalium-output-box" class="output-box">
                <div class="output-title">Kebutuhan KCl</div>
                <div class="output-value"><span id="displayKebutuhanK">0</span> <small>mEq</small></div>
                <div class="output-label"><span id="displayKaliumSerum">0</span> &rarr; <span id="displayKTarget">0</span></div>
                <div class="output-label" style="font-size: 11px;">Delta: <span id="displayDeltaK">0</span></div>
            </div>

            <div id="malnutrisi-output-box" class="output-box" style="background:#fff3e0; border-color:#FF8F00;">
                <div class="output-title" style="color:#E65100;">Diagnosis</div>
                <div class="output-value" id="displayDiagnosis" style="font-size: 16px; color:#BF360C;">-</div>
                <div style="margin-top:8px; font-size:11px; color:#555;">Target Kalori</div>
                <div style="font-weight:bold; color:#333;" id="displayTargetKkal">- kkal/hari</div>
                <div style="font-size:11px; color:#555; margin-top:4px;">Target Protein</div>
                <div style="font-weight:bold; color:#333;" id="displayTargetProtein">- g/hari</div>
            </div>
        </div>

        <!-- SHARED INPUT FORM -->
        <div class="input-form screen-only">
            <div class="form-group"><label>Nama Pasien*:</label><input type="text" id="nama"></div>
            <div class="form-group"><label>No. MR (10 Digit)*:</label><input type="text" id="noMR" maxlength="10"></div>
            <div class="form-group"><label>Tgl Lahir*:</label><input type="date" id="tglLahir"></div>
            <div class="form-group"><label>Jenis Kelamin*:</label><select id="jk"><option value="L">Laki-laki</option><option value="P">Perempuan</option></select></div>
            <div class="form-group"><label>Tgl Assessment*:</label><input type="date" id="tglAsesmen"></div>
            <div class="form-group"><label>Berat Badan (kg)*:</label><input type="number" id="bb"></div>

            <!-- PSI INPUT GROUP -->
            <div id="input-psi-group" style="display:contents;">
                <div class="form-section-title">Riwayat &amp; Komorbiditas</div>
                <div class="checkbox-grid">
                    <label><input type="checkbox" class="psi-check" data-score="30" data-id="cancer"> Keganasan (+30)</label>
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="liver"> Penyakit Hati (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="hf"> Penyakit Jantung Kongestif (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="cvd"> Penyakit Serebrovaskular (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="renal"> Penyakit Ginjal (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="nursing"> Penghuni panti werda (+10)</label>
                </div>
                <div class="form-section-title">Pemeriksaan Fisik</div>
                <div class="checkbox-grid">
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="ams"> Gangguan Kesadaran (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="rr"> Respiratory Rate &gt;30 x/menit (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="sys"> Systolic BP &lt;90 mmHg (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="temp"> Temperature &lt;35¬∞C / &gt;40¬∞C (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="pulse"> Heart Rate &gt; 125 x/menit (+10)</label>
                </div>
                <div class="form-section-title">Laboratorium &amp; Radiologi</div>
                <div class="checkbox-grid">
                    <label><input type="checkbox" class="psi-check" data-score="30" data-id="ph"> pH &lt;7.35 (+30)</label>
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="bun"> Ureum &gt;64.2 mg/dL (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="20" data-id="na"> Natrium &lt;130 mEq/L (+20)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="glu"> Glukosa &gt;250 mg/dL (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="hct"> Hematokrit &lt;30% (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="po2"> PO‚ÇÇ darah Arteri &lt;60 mmHg (+10)</label>
                    <label><input type="checkbox" class="psi-check" data-score="10" data-id="pleural"> Efusi Pleura (+10)</label>
                </div>
            </div>

            <!-- NATRIUM INPUT GROUP -->
            <div id="input-natrium-group" style="display:none; display:contents;">
                <div class="form-group"><label>Na Serum Awal:</label><input type="number" id="naSerum"></div>
                <div class="form-group"><label>Target Na:</label><input type="number" id="naTarget" value="135"></div>
                <div class="form-group"><label>Cairan Infus:</label>
                    <select id="naInfus"><option value="513">NaCl 3%</option><option value="154">NaCl 0.9%</option></select>
                </div>
                <div class="form-group"><label>Max Koreksi (mEq/24h):</label><input type="number" id="naKecepatan" value="8"></div>
            </div>

            <!-- KALIUM INPUT GROUP -->
            <div id="input-kalium-group" style="display:none; display:contents;">
                <div class="form-group"><label>K Serum Awal:</label><input type="number" id="kSerum" step="0.1"></div>
                <div class="form-group"><label>Target K:</label><input type="number" id="kTarget" step="0.1" value="3.0"></div>
                <div class="form-group"><label>Akses Vena:</label>
                    <select id="aksesVena"><option value="perifer">Vena Perifer</option><option value="sentral">Vena Sentral</option></select>
                </div>
            </div>

            <!-- MALNUTRISI INPUT GROUP -->
            <div id="input-malnutrisi-group" style="display:none; display:contents;">
                <div class="form-section-title">Data Tambahan &amp; Parameter Kalkulasi</div>
                <div class="form-group"><label>Ruang/Ward:</label><input type="text" id="ruang" placeholder="cth: ICU, 6 South"></div>
                <div class="form-group"><label>Jam Assessment:</label><input type="time" id="jam"></div>
                <div class="form-group"><label>Tinggi Badan (cm):</label><input type="number" id="tb" placeholder="Opsional (BMI)"></div>
                <div class="form-group"><label>Kondisi / Faktor Stres:</label>
                    <select id="faktorStres">
                        <option value="25">Normal (25 kkal/kg)</option>
                        <option value="27">Stres Ringan (27 kkal/kg)</option>
                        <option value="30" selected>Stres Sedang (30 kkal/kg)</option>
                        <option value="35">Stres Berat (35 kkal/kg)</option>
                    </select>
                </div>
                <div class="form-group"><label>Faktor Protein (g/kg):</label>
                    <select id="faktorProtein">
                        <option value="0.8">0.8 g/kg (Normal)</option>
                        <option value="1.0">1.0 g/kg (Ringan)</option>
                        <option value="1.2" selected>1.2 g/kg (Sedang)</option>
                        <option value="1.5">1.5 g/kg (Berat)</option>
                        <option value="2.0">2.0 g/kg (Kritis/Hiperkatabolik)</option>
                    </select>
                </div>
                <div class="form-group"><label>% Lemak dari Total Kalori:</label>
                    <select id="persenLemak">
                        <option value="20">20%</option>
                        <option value="25" selected>25%</option>
                        <option value="30">30%</option>
                        <option value="35">35%</option>
                    </select>
                </div>
                <div class="form-section-title">Parameter Nutrisi Enteral</div>
                <div class="form-group"><label>Densitas Formula:</label>
                    <select id="densitasFormula">
                        <option value="1.0">Standard 1.0 kkal/mL</option>
                        <option value="1.5">High-Cal 1.5 kkal/mL</option>
                        <option value="2.0">High-Cal 2.0 kkal/mL</option>
                    </select>
                </div>
                <div class="form-group"><label>Frekuensi Pemberian:</label>
                    <select id="frekEnteral">
                        <option value="3">3√ó sehari</option>
                        <option value="4" selected>4√ó sehari</option>
                        <option value="5">5√ó sehari</option>
                        <option value="6">6√ó sehari</option>
                        <option value="0">Kontinyu 24 jam</option>
                    </select>
                </div>
                <div class="form-group"><label>% Kalori Enteral dari Target:</label>
                    <select id="pctEnteral">
                        <option value="100" selected>100%</option>
                        <option value="75">75%</option>
                        <option value="50">50%</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- CONTENT SECTIONS -->
        <div id="calc-psi-content" class="calc-content"></div>
        <div id="calc-natrium-content" class="calc-content" style="display:none;"><div id="natrium-tables-container"></div></div>
        <div id="calc-kalium-content" class="calc-content" style="display:none;">
            <div id="kalium-result-table"><table class="scoring-table"><thead><tr><th>Rencana Tata Laksana</th><th>Instruksi Klinis</th></tr></thead><tbody id="kalium-instructions"></tbody></table></div>
        </div>

        <!-- MALNUTRISI CONTENT -->
        <div id="calc-malnutrisi-content" class="calc-content" style="display:none;">

            <!-- Helper: Target Kalori & Protein (screen only) -->
            <div class="helper-box screen-only">
                <div class="helper-box-title">üßÆ Kalkulator Target Nutrisi</div>
                <div class="helper-results">
                    <div class="helper-result-item">
                        <div class="hval" id="hTargetKkal">-</div>
                        <div class="hlabel">Target Kalori (kkal/hari)</div>
                    </div>
                    <div class="helper-result-item">
                        <div class="hval" id="hTargetProtein">-</div>
                        <div class="hlabel">Target Protein (g/hari)</div>
                    </div>
                    <div class="helper-result-item">
                        <div class="hval" id="hTargetLemak">-</div>
                        <div class="hlabel">Target Lemak (g/hari)</div>
                    </div>
                    <div class="helper-result-item">
                        <div class="hval" id="hTargetKarbo">-</div>
                        <div class="hlabel">Target KH (g/hari)</div>
                    </div>
                    <div class="helper-result-item">
                        <div class="hval" id="hBMI">-</div>
                        <div class="hlabel">BMI (kg/m¬≤)</div>
                    </div>
                    <div class="helper-result-item">
                        <div class="hval" id="hFaktorKalori">-</div>
                        <div class="hlabel">Faktor Kalori (kkal/kg)</div>
                    </div>
                </div>

                <!-- Enteral Helper -->
                <div class="enteral-helper" id="enteral-helper-section">
                    <div class="enteral-helper-title">üçº Rencana Nutrisi Enteral</div>
                    <div class="enteral-results">
                        <div class="enteral-result-item">
                            <div class="eval" id="eVolTotal">-</div>
                            <div class="elabel">Volume Total (mL/hari)</div>
                        </div>
                        <div class="enteral-result-item">
                            <div class="eval" id="eVolPerPemberian">-</div>
                            <div class="elabel">Volume/Pemberian (mL)</div>
                        </div>
                        <div class="enteral-result-item">
                            <div class="eval" id="eKecepatan">-</div>
                            <div class="elabel">Kecepatan Infus (mL/jam)</div>
                        </div>
                    </div>
                    <button class="autofill-btn" onclick="autofillEnteral()">‚¨á Auto-isi Kolom Terapi Enteral</button>
                </div>
            </div>

            <!-- FORM TATALAKSANA MALNUTRISI -->
            <div style="text-align:center; font-weight:bold; font-size:14px; padding: 8px; background:#37474f; color:white; border-radius:4px 4px 0 0; margin-top:5px;">
                FORM TATALAKSANA MALNUTRISI
            </div>
            <table class="malnutrisi-form-table">
                <thead>
                    <tr>
                        <th class="col-no">No.</th>
                        <th class="col-jenis">Jenis</th>
                        <th class="col-terapi">Tindakan / Terapi</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- 1. Skrining gizi -->
                    <tr>
                        <td class="col-no">1.</td>
                        <td class="col-jenis">Skrining gizi</td>
                        <td>
                            <div class="screen-only" style="margin-bottom:4px;">
                                <select id="hasilSkrining" onchange="updateStats()" style="padding:3px 6px; border:1px solid #ccc; border-radius:3px; font-size:12px; margin-right:5px;">
                                    <option value="">-- Pilih Hasil Skrining --</option>
                                    <optgroup label="SGA (Subjective Global Assessment)">
                                        <option value="SGA A (Gizi Baik)">SGA A ‚Äî Gizi Baik</option>
                                        <option value="SGA B (Malnutrisi Ringan-Sedang)">SGA B ‚Äî Malnutrisi Ringan-Sedang</option>
                                        <option value="SGA C (Malnutrisi Berat)">SGA C ‚Äî Malnutrisi Berat</option>
                                    </optgroup>
                                    <optgroup label="NRS-2002">
                                        <option value="NRS-2002 skor &lt;3 (Tidak Berisiko)">NRS-2002 &lt;3 ‚Äî Tidak Berisiko</option>
                                        <option value="NRS-2002 skor ‚â•3 (Berisiko Malnutrisi)">NRS-2002 ‚â•3 ‚Äî Berisiko Malnutrisi</option>
                                    </optgroup>
                                    <optgroup label="MNA (Lansia)">
                                        <option value="MNA Normal (‚â•24 poin)">MNA Normal ‚â•24 poin</option>
                                        <option value="MNA Risiko Malnutrisi (17-23.5 poin)">MNA Risiko (17‚Äì23.5 poin)</option>
                                        <option value="MNA Malnutrisi (&lt;17 poin)">MNA Malnutrisi &lt;17 poin</option>
                                    </optgroup>
                                </select>
                            </div>
                            <div id="printSkrining" style="font-size:12px; min-height:16px;"></div>
                            <textarea class="malnutrisi-textarea screen-only" id="skriningDetail" placeholder="Catatan tambahan skrining gizi..."></textarea>
                        </td>
                    </tr>

                    <!-- 2. Asessmen medik gizi -->
                    <tr>
                        <td class="col-no">2.</td>
                        <td class="col-jenis">Asessmen medik gizi</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="asessmen" placeholder="cth: BB turun, kehilangan lemak subkutan, edema (+), albumin 1.4 g/dL..."></textarea>
                        </td>
                    </tr>

                    <!-- 3. Terapi medik gizi -->
                    <tr>
                        <td class="col-no">3.</td>
                        <td class="col-jenis">Terapi medik gizi</td>
                        <td>
                            <div id="printTargetRingkas" style="font-size:12px; min-height:16px; margin-bottom:4px; font-style:italic;"></div>
                            <textarea class="malnutrisi-textarea" id="terapiMedikGizi" placeholder="Ringkasan target & terapi, cth: Target 1800 kkal, 90g protein, 50g lemak. Vit B kap 3√ó1tab, Zinc 2√ó20mg, Vit C 3√ó100mg."></textarea>
                        </td>
                    </tr>

                    <!-- 3a. Terapi nutrisi oral -->
                    <tr style="background:#fafafa;">
                        <td class="col-no" style="font-size:11px; color:#666;">3a.</td>
                        <td class="col-jenis sub-label">Terapi nutrisi oral</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="terapiOral" placeholder="cth: Diet TKTP 1800 kkal, suplemen oral 2√ó1 sach..."></textarea>
                        </td>
                    </tr>

                    <!-- 3b. Terapi nutrisi enteral -->
                    <tr style="background:#fafafa;">
                        <td class="col-no" style="font-size:11px; color:#666;">3b.</td>
                        <td class="col-jenis sub-label">Terapi nutrisi enteral</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="terapiEnteral" placeholder="Klik 'Auto-isi' di atas atau tulis manual, cth: mulai 1300 kkal via NGT, sonde 4√ó200 mL enteral..."></textarea>
                        </td>
                    </tr>

                    <!-- 3c. Terapi nutrisi parenteral -->
                    <tr style="background:#fafafa;">
                        <td class="col-no" style="font-size:11px; color:#666;">3c.</td>
                        <td class="col-jenis sub-label">Terapi nutrisi parenteral</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="terapiParenteral" placeholder="cth: Aminofluid 500 mL/24 jam, Clinimix 1000 mL/24 jam..."></textarea>
                        </td>
                    </tr>

                    <!-- 4. Edukasi gizi -->
                    <tr>
                        <td class="col-no">4.</td>
                        <td class="col-jenis">Edukasi gizi</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="edukasiGizi" placeholder="cth: Diet enteral biasanya sesuai kondisi, edukasi keluarga tentang pentingnya asupan adekuat..."></textarea>
                        </td>
                    </tr>

                    <!-- 5. Monev gizi -->
                    <tr>
                        <td class="col-no">5.</td>
                        <td class="col-jenis">Monev gizi</td>
                        <td>
                            <div class="screen-only" style="display:flex; flex-wrap:wrap; gap:8px; margin-bottom:6px; font-size:12px;">
                                <label><input type="checkbox" class="monev-check" value="Terapi enteral/parenteral"> Terapi enteral/parenteral</label>
                                <label><input type="checkbox" class="monev-check" value="Asupan harian"> Asupan harian</label>
                                <label><input type="checkbox" class="monev-check" value="Albumin"> Albumin</label>
                                <label><input type="checkbox" class="monev-check" value="Berat badan"> Berat badan</label>
                                <label><input type="checkbox" class="monev-check" value="Kalau puasa"> Kalau puasa</label>
                                <label><input type="checkbox" class="monev-check" value="Lab lanjutan (prealbumin, transferin)"> Lab lanjutan</label>
                            </div>
                            <div id="printMonev" style="font-size:12px; min-height:16px;"></div>
                            <textarea class="malnutrisi-textarea screen-only" id="monevDetail" placeholder="Catatan tambahan monitoring & evaluasi..."></textarea>
                        </td>
                    </tr>

                    <!-- 6. Rujuk balik -->
                    <tr>
                        <td class="col-no">6.</td>
                        <td class="col-jenis">Rujuk balik kontrol ke poli gizi klinik</td>
                        <td>
                            <textarea class="malnutrisi-textarea" id="rujukBalik" placeholder="cth: Rujuk kontrol poli gizi 2 minggu pasca pulang..."></textarea>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- KESIMPULAN -->
            <div class="kesimpulan-box">
                <div class="kesimpulan-catatan">
                    <strong>CATATAN:</strong> Diagnosis Malnutrisi ditegakkan apabila memenuhi minimal 2 dari 6 kriteria di atas
                    ATAU memenuhi kriteria Tambahan seperti Kriteria Antropometri ATAU pemeriksaan laboratorium.
                </div>
                <div class="kesimpulan-title">KESIMPULAN:</div>
                <div class="kesimpulan-options">
                    <label>
                        <input type="radio" name="kesimpulan" id="radioSedang" value="MALNUTRISI SEDANG" onchange="updateStats()">
                        MALNUTRISI SEDANG
                    </label>
                    <label>
                        <input type="radio" name="kesimpulan" id="radioBerat" value="MALNUTRISI BERAT" onchange="updateStats()">
                        MALNUTRISI BERAT
                    </label>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer-section">
            <div class="button-container screen-only">
                <button onclick="printAndDownload()" class="btn-action btn-print">Print / Save PDF</button>
                <button onclick="location.reload()" class="btn-action btn-clear">Clear</button>
            </div>
            <div class="dpjp-section">
                <p>Medan, <span id="displayTanggalPrint"></span></p>
                <p class="dpjp-title-default">Diketahui oleh,</p>
                <p class="dpjp-title-malnutrisi">Dokter Spesialis Gizi Klinis,</p>
                <input type="text" id="inputDPJP" placeholder="Nama Dokter*" class="screen-only dpjp-input">
                <div id="displayDPJP" class="dpjp-name"></div>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'psi';

        function showCalculator(mode) {
            currentMode = mode;
            document.body.className = 'mode-' + mode;

            document.querySelectorAll('.btn-tab').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${mode}`).classList.add('active');

            const allModes = ['psi', 'natrium', 'kalium', 'malnutrisi'];
            allModes.forEach(m => {
                document.getElementById(`calc-${m}-content`).style.display = 'none';
                document.getElementById(`${m}-output-box`).style.display = 'none';
            });
            document.getElementById(`calc-${mode}-content`).style.display = 'block';
            document.getElementById(`${mode}-output-box`).style.display = 'flex';

            document.getElementById('input-psi-group').style.display = (mode === 'psi') ? 'contents' : 'none';
            document.getElementById('input-natrium-group').style.display = (mode === 'natrium') ? 'contents' : 'none';
            document.getElementById('input-kalium-group').style.display = (mode === 'kalium') ? 'contents' : 'none';
            document.getElementById('input-malnutrisi-group').style.display = (mode === 'malnutrisi') ? 'contents' : 'none';

            updateStats();
        }

        function formatDateIndo(dateString) {
            if (!dateString) return "-";
            const date = new Date(dateString);
            if (isNaN(date)) return "-";
            const months = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Agu", "Sep", "Okt", "Nov", "Des"];
            return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const inputs = ['nama', 'noMR', 'inputDPJP', 'tglAsesmen', 'tglLahir', 'jk', 'bb',
                            'naSerum', 'naTarget', 'naKecepatan', 'naInfus',
                            'kSerum', 'kTarget', 'aksesVena',
                            'ruang', 'jam', 'tb', 'faktorStres', 'faktorProtein', 'persenLemak',
                            'densitasFormula', 'frekEnteral', 'pctEnteral', 'hasilSkrining'];
            inputs.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener((el.tagName === 'SELECT' || el.type === 'date' || el.type === 'time') ? 'change' : 'input', updateStats);
            });
            document.querySelectorAll('.psi-check').forEach(box => box.addEventListener('change', updateStats));
            document.querySelectorAll('.monev-check').forEach(box => box.addEventListener('change', updateStats));

            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tglAsesmen').value = today;
            document.getElementById('displayTanggalPrint').textContent = formatDateIndo(today);

            // Auto-expand textareas
            document.querySelectorAll('.malnutrisi-textarea').forEach(ta => {
                ta.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = this.scrollHeight + 'px';
                });
            });

            showCalculator('psi');
        });

        function updateStats() {
            setText('displayNama', getValue('nama') || '-');
            setText('displayNoMR', getValue('noMR') || '-');
            setText('displayDPJP', getValue('inputDPJP') || '');
            setText('displayTglAsesmen', formatDateIndo(getValue('tglAsesmen')));
            setText('displayTglLahir', formatDateIndo(getValue('tglLahir')));
            setText('displayTanggalPrint', formatDateIndo(getValue('tglAsesmen')));
            setText('displayRuang', getValue('ruang') || '-');
            setText('displayJam', getValue('jam') || '-');

            const tgl = getValue('tglLahir');
            if (tgl) {
                const dob = new Date(tgl);
                const today = new Date();
                let age = today.getFullYear() - dob.getFullYear();
                if (today.getMonth() < dob.getMonth() || (today.getMonth() === dob.getMonth() && today.getDate() < dob.getDate())) age--;
                setText('displayUmur', age + " Tahun");
            }

            try { calculatePSI(); } catch(e) {}
            try { calculateNatrium(); } catch(e) {}
            try { calculateKalium(); } catch(e) {}
            try { calculateMalnutrisi(); } catch(e) {}
        }

        function calculateMalnutrisi() {
            const bb = parseFloat(getValue('bb'));
            const tb = parseFloat(getValue('tb'));
            const faktorKalori = parseFloat(getValue('faktorStres')) || 30;
            const faktorProt = parseFloat(getValue('faktorProtein')) || 1.2;
            const pctLemak = parseFloat(getValue('persenLemak')) || 25;
            const densitas = parseFloat(getValue('densitasFormula')) || 1.0;
            const frek = parseInt(getValue('frekEnteral')) || 4;
            const pctEnteral = parseFloat(getValue('pctEnteral')) || 100;

            // BMI
            let bmiText = '-';
            if (bb && tb) {
                const tbM = tb / 100;
                const bmi = bb / (tbM * tbM);
                bmiText = bmi.toFixed(1);
            }
            setText('hBMI', bmiText);
            setText('hFaktorKalori', bb ? faktorKalori : '-');

            if (!bb) {
                ['hTargetKkal','hTargetProtein','hTargetLemak','hTargetKarbo',
                 'eVolTotal','eVolPerPemberian','eKecepatan',
                 'displayTargetKkal','displayTargetProtein'].forEach(id => setText(id, '-'));
                return;
            }

            // Nutritional targets
            const targetKkal = Math.round(bb * faktorKalori);
            const targetProtein = Math.round(bb * faktorProt * 10) / 10;
            const targetLemakG = Math.round((targetKkal * (pctLemak / 100)) / 9 * 10) / 10;
            const kkalLemak = targetLemakG * 9;
            const kkalProtein = targetProtein * 4;
            const targetKarboG = Math.round(((targetKkal - kkalLemak - kkalProtein) / 4) * 10) / 10;

            setText('hTargetKkal', targetKkal);
            setText('hTargetProtein', targetProtein);
            setText('hTargetLemak', targetLemakG);
            setText('hTargetKarbo', Math.max(0, targetKarboG));
            setText('displayTargetKkal', targetKkal + ' kkal/hari');
            setText('displayTargetProtein', targetProtein + ' g/hari');

            // Auto-populate target summary for terapi field
            const ringkas = `Target: ${targetKkal} kkal/hari, Protein ${targetProtein} g/hari, Lemak ${targetLemakG} g/hari (${pctLemak}%)`;
            const printRingkasEl = document.getElementById('printTargetRingkas');
            if (printRingkasEl) printRingkasEl.textContent = ringkas;

            // Enteral calculation
            const kkalEnteral = targetKkal * (pctEnteral / 100);
            const volTotalML = Math.round(kkalEnteral / densitas);
            setText('eVolTotal', volTotalML);

            if (frek === 0) {
                // Continuous
                const rate = Math.round(volTotalML / 24);
                setText('eVolPerPemberian', '‚Äî');
                setText('eKecepatan', rate + ' mL/jam (kontinyu)');
            } else {
                const volPerPemberian = Math.round(volTotalML / frek);
                const rate = Math.round(volTotalML / 24 * 10) / 10;
                setText('eVolPerPemberian', volPerPemberian);
                setText('eKecepatan', rate);
            }

            // Skrining result ‚Üí print
            const hasilSkrining = getValue('hasilSkrining');
            const skriningDetail = document.getElementById('skriningDetail')?.value || '';
            const printSkriningEl = document.getElementById('printSkrining');
            if (printSkriningEl) {
                printSkriningEl.textContent = [hasilSkrining, skriningDetail].filter(Boolean).join(' ‚Äî ');
            }

            // Monev checkboxes ‚Üí print
            const monevChecked = Array.from(document.querySelectorAll('.monev-check:checked')).map(c => c.value);
            const monevDetail = document.getElementById('monevDetail')?.value || '';
            const printMonevEl = document.getElementById('printMonev');
            if (printMonevEl) {
                const monevItems = [...monevChecked, monevDetail].filter(Boolean);
                printMonevEl.textContent = monevItems.join(', ');
            }

            // Diagnosis / Kesimpulan
            const selected = document.querySelector('input[name="kesimpulan"]:checked');
            const diagnosis = selected ? selected.value : '-';
            setText('displayDiagnosis', diagnosis === '-' ? '-' : diagnosis.replace('MALNUTRISI ', ''));
        }

        function autofillEnteral() {
            const bb = parseFloat(getValue('bb'));
            if (!bb) { alert('Masukkan Berat Badan terlebih dahulu.'); return; }

            const faktorKalori = parseFloat(getValue('faktorStres')) || 30;
            const faktorProt = parseFloat(getValue('faktorProtein')) || 1.2;
            const pctLemak = parseFloat(getValue('persenLemak')) || 25;
            const densitas = parseFloat(getValue('densitasFormula')) || 1.0;
            const frek = parseInt(getValue('frekEnteral')) || 4;
            const pctEnteral = parseFloat(getValue('pctEnteral')) || 100;

            const targetKkal = Math.round(bb * faktorKalori);
            const targetProtein = Math.round(bb * faktorProt * 10) / 10;
            const targetLemakG = Math.round((targetKkal * (pctLemak / 100)) / 9 * 10) / 10;
            const kkalEnteral = targetKkal * (pctEnteral / 100);
            const volTotal = Math.round(kkalEnteral / densitas);

            const densitasLabel = densitas === 1.0 ? 'Standard (1.0 kkal/mL)' : `High-Cal (${densitas} kkal/mL)`;
            let frekLabel, volPerPemberian, rateLabel;

            if (frek === 0) {
                frekLabel = 'kontinyu 24 jam';
                volPerPemberian = null;
                const rate = Math.round(volTotal / 24);
                rateLabel = `${rate} mL/jam`;
            } else {
                frekLabel = `${frek}√ó sehari`;
                volPerPemberian = Math.round(volTotal / frek);
                const rate = Math.round(volTotal / 24 * 10) / 10;
                rateLabel = `${rate} mL/jam`;
            }

            const pctLabel = pctEnteral < 100 ? ` (${pctEnteral}% dari target)` : '';
            let teks = `Nutrisi enteral${pctLabel}: target ${Math.round(kkalEnteral)} kkal/hari, ${targetProtein} g protein.\n`;
            teks += `Formula: ${densitasLabel}, volume total ${volTotal} mL/hari.\n`;
            if (volPerPemberian) {
                teks += `Pemberian: ${frekLabel} √ó ${volPerPemberian} mL/pemberian via NGT/sonde.\n`;
            } else {
                teks += `Pemberian: ${frekLabel} (${rateLabel}).\n`;
            }

            const ta = document.getElementById('terapiEnteral');
            if (ta) {
                ta.value = teks.trim();
                ta.style.height = 'auto';
                ta.style.height = ta.scrollHeight + 'px';
            }

            // Also fill summary in terapi medik gizi if empty
            const taMedik = document.getElementById('terapiMedikGizi');
            if (taMedik && !taMedik.value) {
                taMedik.value = `Target: ${targetKkal} kkal/hari, Protein ${targetProtein} g/hari, Lemak ${targetLemakG} g/hari (${pctLemak}%).`;
                taMedik.style.height = 'auto';
                taMedik.style.height = taMedik.scrollHeight + 'px';
            }
        }

        function calculatePSI() {
            let total = 0;
            let detailsTable = `<table class="scoring-table"><thead><tr><th>Parameter</th><th style="width:50px">Skor</th></tr></thead><tbody>`;

            const tgl = getValue('tglLahir');
            if(tgl) {
                const dob = new Date(tgl);
                const today = new Date();
                let age = today.getFullYear() - dob.getFullYear();
                if (today.getMonth() < dob.getMonth() || (today.getMonth() === dob.getMonth() && today.getDate() < dob.getDate())) age--;
                const jk = getValue('jk');
                let ageScore = (jk === 'P') ? Math.max(0, age - 10) : age;
                total += ageScore;
                detailsTable += `<tr><td>Usia (${age}) + Gender (${jk})</td><td>${ageScore}</td></tr>`;
            }

            document.querySelectorAll('.psi-check').forEach(c => {
                if(c.checked) {
                    const score = parseInt(c.dataset.score);
                    total += score;
                    detailsTable += `<tr><td>${c.parentElement.innerText.split(' (+')[0]}</td><td>${score}</td></tr>`;
                }
            });

            detailsTable += `<tr><td><strong>TOTAL</strong></td><td><strong>${total}</strong></td></tr></tbody></table>`;
            setText('totalScore', total);

            let kelas = "I", mort = "0.1%";
            if(total > 130) { kelas = "V"; mort = "29.2%"; }
            else if(total >= 91) { kelas = "IV"; mort = "8.2%"; }
            else if(total >= 71) { kelas = "III"; mort = "2.8%"; }
            else if(total > 0) { kelas = "II"; mort = "0.6%"; }

            setText('kelasRisiko', kelas);
            setText('mortalityRate', mort);
            document.getElementById('calc-psi-content').innerHTML = detailsTable;
        }

        function calculateNatrium() {
            const bb = parseFloat(getValue('bb'));
            const naSerum = parseFloat(getValue('naSerum'));
            const naTarget = parseFloat(getValue('naTarget'));
            const naInfus = parseFloat(getValue('naInfus'));
            const kecMax = parseFloat(getValue('naKecepatan'));
            const age = parseInt(document.getElementById('displayUmur')?.innerText) || 30;
            const jk = getValue('jk');

            setText('displayNaAwal', naSerum || 0);
            setText('displayNaTarget', naTarget || 0);
            const deltaTotal = naTarget - naSerum;
            setText('displayDeltaTotal', !isNaN(deltaTotal) ? deltaTotal.toFixed(1) : 0);

            const container = document.getElementById('natrium-tables-container');
            if (!bb || isNaN(naSerum) || isNaN(naTarget) || !container) return;

            container.innerHTML = "";
            if (deltaTotal <= 0) { container.innerHTML = "<tr><td colspan='2'>Target tercapai / Nilai serum lebih tinggi.</td></tr>"; return; }

            let tglAsesmen = getValue('tglAsesmen') ? new Date(getValue('tglAsesmen')) : new Date();
            let factor = (age <= 18) ? 0.6 : (jk === 'L' ? (age > 65 ? 0.5 : 0.6) : (age > 65 ? 0.45 : 0.5));
            const tbw = bb * factor;
            const deltaPerLiter = (naInfus - naSerum) / (tbw + 1);

            let sisaDelta = deltaTotal;
            let hari = 1;
            while (sisaDelta > 0.01) {
                let deltaHariIni = Math.min(sisaDelta, kecMax);
                const volmL = (deltaHariIni / deltaPerLiter) * 1000;
                const botol = Math.ceil(volmL / 500);
                const speed = (volmL / 24).toFixed(1);

                let d = new Date(tglAsesmen); d.setDate(tglAsesmen.getDate() + (hari - 1));
                const months = ["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
                const dateStr = `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;

                container.innerHTML += `
                <table class="scoring-table">
                    <thead><tr><th style="background:${hari === 1 ? '#4CAF50' : '#2196F3'}; color:white;">Rencana Hari ke-${hari} (${dateStr})</th><th>Hasil</th></tr></thead>
                    <tbody>
                        ${hari === 1 ? `<tr><td>TBW</td><td>${tbw.toFixed(1)} L</td></tr>` : ''}
                        <tr><td>Target &Delta; Na+</td><td>${deltaHariIni.toFixed(1)} mEq/L</td></tr>
                        <tr class="highlight-natrium"><td>Kebutuhan</td><td>${botol} Botol (Total ${volmL.toFixed(0)} mL)</td></tr>
                        <tr class="highlight-natrium"><td>Kecepatan</td><td>${speed} mL/jam</td></tr>
                    </tbody>
                </table>`;
                sisaDelta -= deltaHariIni;
                hari++;
                if(hari > 7) break;
            }
        }

        function calculateKalium() {
            const bb = parseFloat(getValue('bb'));
            const kSerum = parseFloat(getValue('kSerum'));
            const kTarget = parseFloat(getValue('kTarget')) || 3.0;
            const akses = getValue('aksesVena');

            setText('displayKaliumSerum', kSerum || 0);
            setText('displayKTarget', kTarget);
            const deltaK = kTarget - kSerum;
            setText('displayDeltaK', !isNaN(deltaK) && deltaK > 0 ? deltaK.toFixed(1) : "0");

            const kebutuhan = 0.3 * bb * (kTarget - kSerum);
            setText('displayKebutuhanK', !isNaN(kebutuhan) && kebutuhan > 0 ? kebutuhan.toFixed(1) : "0");

            const container = document.getElementById('kalium-instructions');
            if (!bb || isNaN(kSerum) || !container) return;

            if (kSerum >= kTarget) { container.innerHTML = `<tr><td colspan="2" style="text-align:center; color:green;">Kadar Normal.</td></tr>`; return; }

            const jumlahBotol = Math.ceil(kebutuhan / 25);
            const obatVol = jumlahBotol * 25;
            let rows = `
                <tr><td>Kalium Serum</td><td>${kSerum.toFixed(2)} mEq/L</td></tr>
                <tr><td>Target Koreksi</td><td>${kTarget.toFixed(1)} mEq/L</td></tr>
                <tr><td>Dosis Total</td><td><strong>${kebutuhan.toFixed(1)} mEq</strong> (${jumlahBotol} Botol KCl)</td></tr>
            `;

            if (akses === 'sentral') {
                const p1 = jumlahBotol * 100; const t1 = p1 + obatVol; const s1 = (t1 / 24).toFixed(1);
                const p2 = jumlahBotol * 500; const t2 = p2 + obatVol; const s2 = (t2 / 24).toFixed(1);
                rows += `
                    <tr style="background:#e3f2fd;"><td colspan="2" style="font-weight:bold; text-align:center;">OPSI VENA SENTRAL</td></tr>
                    <tr><td><strong>Opsi A (Pekat)</strong></td><td>Pelarut: ${p1} mL NaCl<br>Total: ${t1} mL<br>Kecepatan: <strong>${s1} mL/jam</strong></td></tr>
                    <tr><td><strong>Opsi B (Encer)</strong></td><td>Pelarut: ${p2} mL NaCl<br>Total: ${t2} mL<br>Kecepatan: <strong>${s2} mL/jam</strong></td></tr>
                `;
            } else {
                const pP = jumlahBotol * 500; const tP = pP + obatVol; const sP = (tP / 24).toFixed(1);
                rows += `
                    <tr><td>Akses Vena</td><td>Vena Perifer Besar</td></tr>
                    <tr style="background:#fff3e0;"><td>Cairan Pelarut</td><td><strong>${pP} mL NaCl 0.9%</strong></td></tr>
                    <tr style="background:#fff3e0;"><td>Volume Total Campuran</td><td><strong>${tP} mL</strong></td></tr>
                    <tr class="highlight-natrium"><td>Kecepatan Infus</td><td><strong>${sP} mL/jam</strong></td></tr>
                `;
            }
            container.innerHTML = rows;
        }

        function getValue(id) { return document.getElementById(id)?.value; }
        function setText(id, txt) { const el = document.getElementById(id); if (el) el.innerText = txt; }
        function printAndDownload() { window.print(); }
    </script>
</body>
</html>
